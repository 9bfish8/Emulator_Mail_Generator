<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QA ë©”ì¼ ìƒì„±ê¸°</title>
    <style>
        * { box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        h1 { color: #333; text-align: center; }
        .section {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .section h2 {
            margin-top: 0;
            color: #555;
            border-bottom: 2px solid #007bff;
            padding-bottom: 10px;
        }
        .date-input {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-bottom: 15px;
        }
        .date-input input {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        .games-container {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 15px;
        }
        .game-tag {
            display: flex;
            align-items: center;
            background: #f5d427;
            padding: 8px 12px;
            border-radius: 4px;
            gap: 8px;
        }
        .game-tag input {
            border: none;
            background: transparent;
            font-size: 14px;
            width: 150px;
        }
        .game-tag .remove-btn {
            background: #dc3545;
            color: white;
            border: none;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            cursor: pointer;
            font-size: 12px;
        }
        .add-game-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 15px;
        }
        th, td {
            border: 1px solid #ababab;
            padding: 10px;
            text-align: center;
            font-size: 14px;
        }
        th {
            background: #cccccc;
        }
        th.game-header {
            background: #f5d427;
        }
        select {
            padding: 6px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        .highlight {
            background-color: #ffff00;
        }
        .btn-group {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 20px;
        }
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
        }
        .btn-primary { background: #007bff; color: white; }
        .btn-success { background: #28a745; color: white; }
        .preview-container {
            background: white;
            padding: 20px;
            border: 1px solid #ddd;
            margin-top: 20px;
        }
        .notes-section textarea {
            width: 100%;
            min-height: 100px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-family: inherit;
            font-size: 14px;
            resize: vertical;
        }
        .notes-section small {
            color: #666;
            display: block;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <h1>ğŸ“§ QA ì—ë®¬ë ˆì´í„° í…ŒìŠ¤íŠ¸ ë©”ì¼ ìƒì„±ê¸°</h1>

    <div class="section">
        <h2>ğŸ“… ë‚ ì§œ ì„¤ì •</h2>
        <div class="date-input">
            <label>í…ŒìŠ¤íŠ¸ ë‚ ì§œ:</label>
            <input type="text" id="testDate" placeholder="260121">
        </div>
    </div>

    <div class="section">
        <h2>ğŸ® í…ŒìŠ¤íŠ¸ ê²Œì„</h2>
        <div class="games-container" id="gamesContainer"></div>
        <button class="add-game-btn" onclick="addGame()">+ ê²Œì„ ì¶”ê°€</button>
    </div>

    <div class="section">
        <h2>ğŸ“Š í…ŒìŠ¤íŠ¸ ê²°ê³¼ ì…ë ¥</h2>
        <table id="testTable">
            <thead id="tableHeader"></thead>
            <tbody id="tableBody"></tbody>
        </table>
    </div>

    <div class="section notes-section">
        <h2>ğŸ“ ë¹„ê³ </h2>
        <textarea id="notesInput" placeholder="â” BlueStacks 5 64bit (11.0)ì—ì„œ ì•±ê°€ë“œë¥¼ ì ìš©í•œ ì•±ì˜ í¬ë˜ì‹œ ë° ë¹„ì •ìƒ ì¢…ë£Œë˜ë˜ ì´ìŠˆëŠ” ìµœì‹  ë²„ì „ì—ì„œë„ ì‹¤ê²Œì„ í…ŒìŠ¤íŠ¸ì‹œ ë™ì¼í•˜ê²Œ ë°œìƒë¨ì„ í™•ì¸í–ˆìŠµë‹ˆë‹¤.
https://works.inca.co.kr/issues/4963"></textarea>
        <small>* ê° í•­ëª©ì€ ì¤„ë°”ê¿ˆìœ¼ë¡œ êµ¬ë¶„ë©ë‹ˆë‹¤. URLì€ ìë™ìœ¼ë¡œ ë§í¬ë¡œ ë³€í™˜ë©ë‹ˆë‹¤.</small>
    </div>

    <div class="btn-group">
        <button class="btn btn-primary" onclick="generatePreview()">ë¯¸ë¦¬ë³´ê¸°</button>
        <button class="btn btn-success" onclick="copyToClipboard()">HTML ë³µì‚¬</button>
    </div>

    <div class="section">
        <h2>ğŸ‘€ ë¯¸ë¦¬ë³´ê¸°</h2>
        <div class="preview-container" id="previewContainer">
            <p style="color: #999; text-align: center;">ë¯¸ë¦¬ë³´ê¸° ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”</p>
        </div>
    </div>

    <script>
        // ì—ë®¬ë ˆì´í„° ëª©ë¡ (ê³ ì •)
        const emulators = [
            { id: 'bluestacks5_rooted', name: 'BlueStacks 5 64bit (ë£¨íŒ…)', android: '9.0', versionKey: 'BlueStacks5' },
            { id: 'bluestacks5', name: 'BlueStacks 5 64bit', android: '11.0', versionKey: 'BlueStacks5' },
            { id: 'nox_rooted', name: 'NOX 64bit (ë£¨íŒ…)', android: '9.0', versionKey: 'NoxPlayer' },
            { id: 'nox', name: 'NOX 64bit', android: '12.0', versionKey: 'NoxPlayer' },
            { id: 'ldplayer', name: 'LDPlayer 64bit', android: '9.0', versionKey: 'LDPlayer9' },
            { id: 'memu_rooted', name: 'MEmu 64bit (ë£¨íŒ…)', android: '9.0', versionKey: 'MEmu' },
            { id: 'memu', name: 'MEmu 64bit', android: '12.0', versionKey: 'MEmu' },
            { id: 'mumu', name: 'MuMuPlayer 64bit', android: '12.0', versionKey: 'MuMuPlayer' }
        ];

        // ê²Œì„ ëª©ë¡
        let games = [
            { name: 'xGame', version: '1.25.2.7' },
            { name: 'HeirofLight', version: '1.25.2.4' }
        ];

        // ë²„ì „ ë°ì´í„° (URL ì¿¼ë¦¬ìŠ¤íŠ¸ë§ì—ì„œ ë°›ì•„ì˜´)
        let versionData = {};

        // ì´ˆê¸°í™”
        function init() {
            parseQueryParams();
            setDefaultDate();
            renderGames();
            renderTable();
        }

        // URL ì¿¼ë¦¬ íŒŒë¼ë¯¸í„° íŒŒì‹±
        function parseQueryParams() {
            const params = new URLSearchParams(window.location.search);
            
            emulators.forEach(emu => {
                const prevKey = `${emu.versionKey}_prev`;
                const latestKey = `${emu.versionKey}_latest`;
                
                if (params.has(prevKey) || params.has(latestKey)) {
                    versionData[emu.versionKey] = {
                        prev: params.get(prevKey) || '',
                        latest: params.get(latestKey) || ''
                    };
                }
            });
        }

        // ê¸°ë³¸ ë‚ ì§œ ì„¤ì •
        function setDefaultDate() {
            const today = new Date();
            const yy = String(today.getFullYear()).slice(-2);
            const mm = String(today.getMonth() + 1).padStart(2, '0');
            const dd = String(today.getDate()).padStart(2, '0');
            document.getElementById('testDate').value = yy + mm + dd;
        }

        // ê²Œì„ ë Œë”ë§
        function renderGames() {
            const container = document.getElementById('gamesContainer');
            container.innerHTML = games.map((game, index) => `
                <div class="game-tag">
                    <input type="text" value="${game.name}" onchange="updateGameName(${index}, this.value)" placeholder="ê²Œì„ëª…">
                    <input type="text" value="${game.version}" onchange="updateGameVersion(${index}, this.value)" placeholder="ë²„ì „" style="width: 80px;">
                    <button class="remove-btn" onclick="removeGame(${index})">Ã—</button>
                </div>
            `).join('');
            renderTable();
        }

        // ê²Œì„ ì¶”ê°€
        function addGame() {
            games.push({ name: 'ìƒˆê²Œì„', version: '1.0.0' });
            renderGames();
        }

        // ê²Œì„ ì œê±°
        function removeGame(index) {
            if (games.length > 1) {
                games.splice(index, 1);
                renderGames();
            }
        }

        // ê²Œì„ ì´ë¦„ ì—…ë°ì´íŠ¸
        function updateGameName(index, value) {
            games[index].name = value;
            renderTable();
        }

        // ê²Œì„ ë²„ì „ ì—…ë°ì´íŠ¸
        function updateGameVersion(index, value) {
            games[index].version = value;
            renderTable();
        }

        // í…Œì´ë¸” ë Œë”ë§
        function renderTable() {
            // í—¤ë”
            const header = document.getElementById('tableHeader');
            header.innerHTML = `
                <tr>
                    <th>ì œí’ˆëª…</th>
                    <th>Android ë²„ì „</th>
                    <th>ì´ì „ ë²„ì „</th>
                    <th>ìµœì‹  ë²„ì „</th>
                    ${games.map(g => `<th class="game-header">${g.name}[${g.version}]</th>`).join('')}
                </tr>
            `;

            // ë°”ë””
            const body = document.getElementById('tableBody');
            body.innerHTML = emulators.map(emu => {
                const data = versionData[emu.versionKey] || {};
                const hasUpdate = data.prev && data.latest && data.prev !== data.latest;
                
                // ì—…ë°ì´íŠ¸ê°€ ìˆìœ¼ë©´ ì´ì „ë²„ì „/ìµœì‹ ë²„ì „, ì—†ìœ¼ë©´ ì´ì „ë²„ì „ì— í˜„ì¬ë²„ì „ í‘œì‹œ
                let prevVersion = '';
                let latestVersion = '-';
                
                if (hasUpdate) {
                    prevVersion = data.prev;
                    latestVersion = data.latest;
                } else if (data.latest) {
                    prevVersion = data.latest;
                    latestVersion = '-';
                } else if (data.prev) {
                    prevVersion = data.prev;
                    latestVersion = '-';
                }

                return `
                    <tr>
                        <td>
                            <span class="${hasUpdate ? 'highlight' : ''}">${emu.name}</span>
                        </td>
                        <td>${emu.android}</td>
                        <td>
                            <span class="${hasUpdate ? 'highlight' : ''}">${prevVersion}</span>
                        </td>
                        <td>
                            <span class="${hasUpdate ? 'highlight' : ''}">${latestVersion}</span>
                        </td>
                        ${games.map((g, gi) => `
                            <td>
                                <select id="result_${emu.id}_${gi}">
                                    <option value="N/T">N/T</option>
                                    <option value="PASS">PASS</option>
                                    <option value="FAIL">FAIL</option>
                                </select>
                            </td>
                        `).join('')}
                    </tr>
                `;
            }).join('');
        }

        // ë¯¸ë¦¬ë³´ê¸° ìƒì„±
        function generatePreview() {
            const html = generateEmailHTML();
            document.getElementById('previewContainer').innerHTML = html;
        }

        // ì´ë©”ì¼ HTML ìƒì„±
        function generateEmailHTML() {
            const testDate = document.getElementById('testDate').value;
            const notes = document.getElementById('notesInput').value;

            // ì¸ì‚¬ë§
            let html = `
<div style="direction: ltr; text-align: left; text-indent: 0px; margin: 0px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSFontService, Calibri, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, 0);">
ì•ˆë…•í•˜ì„¸ìš” ê¸€ë¡œë²Œì‚¬ì—…ë¶€ QAíŒ€ ì •ê°€ì—°ì…ë‹ˆë‹¤.</div>
<div style="direction: ltr; text-align: left; text-indent: 0px; margin: 0px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSFontService, Calibri, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, 0);">
<br>
${testDate} ë‚ ì§œ ê¸°ì¤€ ìµœì‹  í…ŒìŠ¤íŠ¸ ì—ë®¬ë ˆì´í„° í™˜ê²½&nbsp; ë° ê²°ê³¼ ê³µìœ ë“œë¦½ë‹ˆë‹¤.</div>
<div style="direction: ltr; text-align: left; text-indent: 0px; margin: 0px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSFontService, Calibri, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, 0);">
<br>
</div>
<div style="direction: ltr; text-align: left; text-indent: 0px; margin: 0px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSFontService, Calibri, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, 0);">
<br>
</div>
`;

            // í…Œì´ë¸” ì‹œì‘ - ì „ì²´ ë„ˆë¹„ ê³„ì‚°
            const tableWidth = 183.5 + 110.18 + 256.81 + 183.5 + (games.length * 183.5);
            html += `<table style="direction: ltr; text-align: justify; margin-right: auto; margin-left: 0px; color: rgb(36, 36, 36); box-sizing: border-box; border-collapse: collapse; border-spacing: 0px; width: ${tableWidth}px;">
<tbody>
<tr>`;

            // í—¤ë” í–‰
            html += `
<td style="direction: ltr; text-align: center; border-width: 1px; border-style: solid; border-color: rgb(171, 171, 171); background-color: rgb(204, 204, 204); vertical-align: middle; width: 183.5px; min-width: 183.5px; max-width: 183.5px; height: 32.24px; box-sizing: border-box;">
<div style="direction: ltr; text-align: center; margin: 0px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSFontService, Calibri, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, 0);">
ì œí’ˆëª…</div>
</td>
<td style="direction: ltr; text-align: center; border-width: 1px; border-style: solid; border-color: rgb(171, 171, 171); background-color: rgb(204, 204, 204); vertical-align: middle; width: 110.18px; min-width: 110.18px; max-width: 110.18px; height: 32.24px; box-sizing: border-box;">
<div style="direction: ltr; text-align: center; margin: 0px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSFontService, Calibri, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, 0);">
Android ë²„ì „</div>
</td>
<td style="direction: ltr; text-align: center; border-width: 1px; border-style: solid; border-color: rgb(171, 171, 171); background-color: rgb(204, 204, 204); vertical-align: middle; width: 256.81px; min-width: 256.81px; max-width: 256.81px; height: 32.24px; box-sizing: border-box;">
<div style="direction: ltr; text-align: center; margin: 0px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSFontService, Calibri, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, 0);">
ì´ì „ ë²„ì „</div>
</td>
<td style="direction: ltr; text-align: center; border-width: 1px; border-style: solid; border-color: rgb(171, 171, 171); background-color: rgb(204, 204, 204); vertical-align: middle; width: 183.5px; min-width: 183.5px; max-width: 183.5px; height: 32.24px; box-sizing: border-box;">
<div style="direction: ltr; text-align: center; margin: 0px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSFontService, Calibri, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, 0);">
ìµœì‹  ë²„ì „</div>
</td>`;

            // ê²Œì„ í—¤ë”
            games.forEach(game => {
                html += `
<td style="direction: ltr; text-align: center; border-width: 1px; border-style: solid; border-color: rgb(171, 171, 171); background-color: rgb(245, 212, 39); vertical-align: middle; width: 183.5px; min-width: 183.5px; max-width: 183.5px; height: 32.24px; box-sizing: border-box;">
<div style="direction: ltr; text-align: center; margin: 0px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSFontService, Calibri, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, 0);">
${game.name}[${game.version}]</div>
</td>`;
            });

            html += `
</tr>`;

            // ë°ì´í„° í–‰
            emulators.forEach(emu => {
                const data = versionData[emu.versionKey] || {};
                const hasUpdate = data.prev && data.latest && data.prev !== data.latest;
                
                let prevVersion = '';
                let latestVersion = '-';
                
                if (hasUpdate) {
                    prevVersion = data.prev;
                    latestVersion = data.latest;
                } else if (data.latest) {
                    prevVersion = data.latest;
                    latestVersion = '-';
                } else if (data.prev) {
                    prevVersion = data.prev;
                    latestVersion = '-';
                }

                html += `
<tr>`;

                // ì œí’ˆëª…
                if (hasUpdate) {
                    html += `
<td style="direction: ltr; text-align: center; border-width: 1px; border-style: solid; border-color: rgb(171, 171, 171); vertical-align: middle; width: 183.5px; min-width: 183.5px; max-width: 183.5px; height: 27.46px; box-sizing: border-box;">
<div style="direction: ltr; text-align: center; margin: 0px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSFontService, Calibri, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, 0);">
<span style="background-color: rgb(255, 255, 0);">${emu.name}</span></div>
</td>`;
                } else {
                    html += `
<td style="direction: ltr; text-align: center; border-width: 1px; border-style: solid; border-color: rgb(171, 171, 171); vertical-align: middle; width: 183.5px; min-width: 183.5px; max-width: 183.5px; height: 27.46px; box-sizing: border-box;">
<div style="direction: ltr; text-align: center; margin: 0px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSFontService, Calibri, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, 0);">
${emu.name}</div>
</td>`;
                }

                // Android ë²„ì „
                html += `
<td style="direction: ltr; text-align: center; border-width: 1px; border-style: solid; border-color: rgb(171, 171, 171); vertical-align: middle; width: 110.18px; min-width: 110.18px; max-width: 110.18px; height: 27.46px; box-sizing: border-box;">
<div style="direction: ltr; text-align: center; margin: 0px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSFontService, Calibri, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, 0);">
${emu.android}</div>
</td>`;

                // ì´ì „ ë²„ì „
                if (hasUpdate) {
                    html += `
<td style="direction: ltr; text-align: center; border-width: 1px; border-style: solid; border-color: rgb(171, 171, 171); vertical-align: middle; width: 256.81px; min-width: 256.81px; max-width: 256.81px; height: 27.46px; box-sizing: border-box;">
<div style="direction: ltr; text-align: center; margin: 0px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSFontService, Calibri, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, 0);">
<span style="background-color: rgb(255, 255, 0);">${prevVersion}</span></div>
</td>`;
                } else {
                    html += `
<td style="direction: ltr; text-align: center; border-width: 1px; border-style: solid; border-color: rgb(171, 171, 171); vertical-align: middle; width: 256.81px; min-width: 256.81px; max-width: 256.81px; height: 27.46px; box-sizing: border-box;">
<div style="direction: ltr; text-align: center; margin: 0px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSFontService, Calibri, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, 0);">
${prevVersion}</div>
</td>`;
                }

                // ìµœì‹  ë²„ì „
                if (hasUpdate) {
                    html += `
<td style="direction: ltr; text-align: center; border-width: 1px; border-style: solid; border-color: rgb(171, 171, 171); vertical-align: middle; width: 183.5px; min-width: 183.5px; max-width: 183.5px; height: 27.46px; box-sizing: border-box;">
<div style="direction: ltr; text-align: center; margin: 0px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSFontService, Calibri, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, 0);">
<span style="background-color: rgb(255, 255, 0);">${latestVersion}</span></div>
</td>`;
                } else {
                    html += `
<td style="direction: ltr; text-align: center; border-width: 1px; border-style: solid; border-color: rgb(171, 171, 171); vertical-align: middle; width: 183.5px; min-width: 183.5px; max-width: 183.5px; height: 27.46px; box-sizing: border-box;">
<div style="direction: ltr; text-align: center; margin: 0px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSFontService, Calibri, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, 0);">
${latestVersion}</div>
</td>`;
                }

                // ê²Œì„ë³„ ê²°ê³¼
                games.forEach((game, gi) => {
                    const selectEl = document.getElementById(`result_${emu.id}_${gi}`);
                    const result = selectEl ? selectEl.value : 'N/T';
                    
                    let resultStyle = 'color: rgb(0, 0, 0);';
                    let resultText = result;
                    
                    if (result === 'PASS') {
                        resultStyle = 'color: rgb(12, 100, 192);';
                        resultText = '<b>PASS</b>';
                    } else if (result === 'FAIL') {
                        resultStyle = 'color: rgb(200, 38, 19);';
                        resultText = '<b>FAIL</b>';
                    }

                    html += `
<td style="direction: ltr; text-align: center; border-width: 1px; border-style: solid; border-color: rgb(171, 171, 171); vertical-align: middle; width: 183.5px; min-width: 183.5px; max-width: 183.5px; height: 27.46px; box-sizing: border-box;">
<div style="direction: ltr; text-align: center; margin: 0px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSFontService, Calibri, Helvetica, sans-serif; font-size: 12pt; ${resultStyle}">
${resultText}</div>
</td>`;
                });

                html += `
</tr>`;
            });

            html += `
</tbody>
</table>`;

            // ë¹„ê³ ë€
            if (notes.trim()) {
                html += `
<div style="font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSFontService, Calibri, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, 0);">
<br>
</div>
<div style="font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSFontService, Calibri, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, 0);">
<br>
</div>
<ul style="direction: ltr; margin-top: 0px; margin-bottom: 0px;" data-editing-info="{&quot;applyListStyleFromLevel&quot;:false,&quot;unorderedStyleType&quot;:5}">`;

                const noteLines = notes.split('\n').filter(line => line.trim());
                let inListItem = false;
                
                noteLines.forEach((line, index) => {
                    const trimmedLine = line.trim();
                    const isUrl = trimmedLine.startsWith('http://') || trimmedLine.startsWith('https://');
                    
                    if (isUrl && inListItem) {
                        // URLì„ í˜„ì¬ ë¦¬ìŠ¤íŠ¸ ì•„ì´í…œì— ì¶”ê°€
                        html += `
<div style="direction: ltr; margin: 0px;" role="presentation"><a style="margin: 0px;" href="${trimmedLine}">${trimmedLine}</a></div>
</li>`;
                        inListItem = false;
                    } else if (!isUrl) {
                        // ìƒˆ ë¦¬ìŠ¤íŠ¸ ì•„ì´í…œ ì‹œì‘
                        if (inListItem) {
                            html += `
</li>`;
                        }
                        html += `
<li style="font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSFontService, Calibri, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, 0); direction: ltr; margin-right: 0px; margin-left: 0px; list-style-type: &quot;â” &quot;;">
<div style="direction: ltr; margin-top: 0px; margin-bottom: 0px;" role="presentation">${trimmedLine.replace(/^â”\s*/, '')}</div>`;
                        inListItem = true;
                    }
                });
                
                if (inListItem) {
                    html += `
</li>`;
                }

                html += `
</ul>`;
            }

            return html;
        }

        // í´ë¦½ë³´ë“œì— ë³µì‚¬
        function copyToClipboard() {
            const html = generateEmailHTML();
            
            // HTMLì„ í´ë¦½ë³´ë“œì— ë³µì‚¬ (ë¦¬ì¹˜ í…ìŠ¤íŠ¸)
            const blob = new Blob([html], { type: 'text/html' });
            const clipboardItem = new ClipboardItem({ 'text/html': blob });
            
            navigator.clipboard.write([clipboardItem]).then(() => {
                alert('âœ… HTMLì´ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!\nOutlookì—ì„œ Ctrl+Vë¡œ ë¶™ì—¬ë„£ê¸° í•˜ì„¸ìš”.');
            }).catch(err => {
                // í´ë°±: í…ìŠ¤íŠ¸ë¡œ ë³µì‚¬
                navigator.clipboard.writeText(html).then(() => {
                    alert('ğŸ“‹ HTML ì½”ë“œê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.\nOutlookì—ì„œ HTML í¸ì§‘ ëª¨ë“œë¡œ ë¶™ì—¬ë„£ê¸° í•˜ì„¸ìš”.');
                });
            });
        }

        // ì´ˆê¸°í™” ì‹¤í–‰
        init();
    </script>
</body>
</html>
